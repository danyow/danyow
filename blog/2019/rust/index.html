<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=":D RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=":D Atom Feed"><title data-rh="true">Rust | :D</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danyow.cn/blog/2019/rust"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Rust | :D"><meta data-rh="true" name="description" content="Title: Mac 下学习使用 Rust"><meta data-rh="true" property="og:description" content="Title: Mac 下学习使用 Rust"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-12-04T22:39:06.000Z"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danyow.cn/blog/2019/rust"><link data-rh="true" rel="alternate" href="https://danyow.cn/blog/2019/rust" hreflang="zh"><link data-rh="true" rel="alternate" href="https://danyow.cn/blog/2019/rust" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5764f37d.css">
<link rel="preload" href="/assets/js/runtime~main.48a3e1d8.js" as="script">
<link rel="preload" href="/assets/js/main.c1c30879.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">:D</b></a><a class="navbar__item navbar__link" href="/note/itinerary">笔记</a><a class="navbar__item navbar__link" href="/lua/lua">lua</a><a class="navbar__item navbar__link" href="/unity/unity">unity</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/danyow/danyow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="切换浅色/暗黑模式（当前为浅色模式）"></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2021/note">笔记</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2021/archwsl-03-15">安装ArchWSL</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2019/scoop">Scoop的安装</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2020/server">部署新安装的centos服务器</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/2019/rust">Rust</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_uMeh" itemprop="headline">Rust</h1><div class="blogPostData_Vfxe margin-vert--md"><time datetime="2019-12-04T22:39:06.000Z" itemprop="datePublished">2019年12月4日</time> · <!-- -->36 分钟阅读</div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>Title: Mac 下学习使用 <em>Rust</em></p><h2 class="anchor anchorWithStickyNavbar_loeA" id="安装">安装<a class="hash-link" href="#安装" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_loeA" id="brew-安装">brew 安装<a class="hash-link" href="#brew-安装" title="标题的直接链接">​</a></h3><p>测试之后, 环境有很多内容有没安装上, 估计也是没有配置环境的原因</p><h3 class="anchor anchorWithStickyNavbar_loeA" id="官网方法">官网方法<a class="hash-link" href="#官网方法" title="标题的直接链接">​</a></h3><ol><li><p><code>curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></p></li><li><p>导入环境参数 <code>export PATH=&quot;$PATH:$HOME/.cargo/bin&quot;</code></p></li><li><p><code>rustc --version</code></p></li></ol><h2 class="anchor anchorWithStickyNavbar_loeA" id="入门">入门<a class="hash-link" href="#入门" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_loeA" id="rustc-编译">rustc 编译<a class="hash-link" href="#rustc-编译" title="标题的直接链接">​</a></h3><p>随便写一个 <code>main.rs</code> 文件, 然后键入下述内容.</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Hello, world!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>然后执行<code>rustc main.rs</code>得到编译后的可执行文件<code>./main</code>即可看到打印</p><h3 class="anchor anchorWithStickyNavbar_loeA" id="cargo">Cargo<a class="hash-link" href="#cargo" title="标题的直接链接">​</a></h3><p>如果安装的时候用的是官网的方法的话, 是会让你选择第几个安装方式, 我们通常选择第一个采用默认的方式, 这样就会把Cargo所需要的也就一起下载安装下来了. 在到我们配置环境输入的<code>PATH</code>也是一样</p><ol><li><p>新建项目
<code>cargo new hello_cargo</code></p></li><li><p>编译项目
<code>cargo build</code> or <code>cargo build --release</code></p></li><li><p>运行项目
<code>cargo run</code></p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="编写猜谜游戏">编写猜谜游戏<a class="hash-link" href="#编写猜谜游戏" title="标题的直接链接">​</a></h3><ol><li><p>直接编写</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;    // 使用标准库的io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Guess the number!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Please input your guess.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut guess = String::new(); // 定义一个可变的变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    io::stdin().read_line(&amp;mut guess)   // 换行的原因只是因为过长了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;Failed to read line&quot;); // 处理可能的报错</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;You guessed: {}&quot;, guess);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>加入<code>rand</code>库</p><p>在<code>Cargo.toml</code>文件中加入</p><div class="codeBlockContainer_X7hc language-toml theme-code-block"><div class="codeBlockContent_vqWU toml"><pre tabindex="0" class="prism-code language-toml codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rand = &quot;0.3.14&quot;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>然后编译<code>cargo build</code>或者是<code>cargo run</code>可能会遇到
<code>Blocking waiting for file lock on package cache</code>
如果执行得是<code>cargo update</code>就不会遇到<code>Cargo.lock</code>文件了</p><p>这里指定了<code>0.3.14</code>版本并不是真的就只使用该版本, 而是会使用兼容该版本的更高版本</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use rand::Rng;  // 导入 随机库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Guess the number!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let secret_number = rand::thread_rng().gen_range(1, 101);   // 生成一个 0 ~ 100 的随机数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;The secret number is: {}&quot;, secret_number);    // 测试打印</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Please input your guess.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut guess = String::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    io::stdin().read_line(&amp;mut guess)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;Failed to read line&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // trim 的是就是删除某些东西 由于 键入的时候最后面会敲击回车 导致\n会加入进来</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let guess: u32 = guess.trim().parse()   // 用 同一个变量名 去覆盖 guess 并转成 u32类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .expect(&quot;Please type a number!&quot;);   // 转换类型也是有可能报错的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;You guessed: {}&quot;, guess);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    match guess.cmp(&amp;secret_number) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ordering::Less =&gt; println!(&quot;Too small!&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ordering::Greater =&gt; println!(&quot;Too big!&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ordering::Equal =&gt; println!(&quot;You win!&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>加入循环</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;The secret number is: {}&quot;, secret_number);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loop {  // 加入循环</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println!(&quot;Please input your guess.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match guess.cmp(&amp;secret_number) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Ordering::Less =&gt; println!(&quot;Too small!&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Ordering::Greater =&gt; println!(&quot;Too big!&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Ordering::Equal =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                println!(&quot;You win!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;  // 在这里退出循环</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>处理非数字的输入</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">io::stdin().read_line(&amp;mut guess)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .expect(&quot;Failed to read line&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 加入match来对报错的 continue来处理非数字的输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let guess: u32 = match guess.trim().parse() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ok(num) =&gt; num,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Err(_) =&gt; continue,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;You guessed: {}&quot;, guess);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// --snip--</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="通用编程概念">通用编程概念<a class="hash-link" href="#通用编程概念" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="变量和可变性">变量和可变性<a class="hash-link" href="#变量和可变性" title="标题的直接链接">​</a></h4><ol><li>这里的变量不是指能变的量, 而是一个定义, 但只要赋予了 <code>mut</code> 才是真的可以变</li><li>常量的命名规则 单词全大写 下划线分隔 就连int <code>100,000</code> 都可以表示为 <code>100_000</code></li><li>变量可以被重复声明并覆盖原值 但不能改变原有数据类型 也就是不能 string =&gt; int</li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="资料类型">资料类型<a class="hash-link" href="#资料类型" title="标题的直接链接">​</a></h4><ol><li><p>编译时需要帮忙确定类型</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let guess: u32 = &quot;42&quot;.parse().expect(&quot;Not a number!&quot;);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>整型的表示形式有</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    小数        98_222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    十六        0xff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    八进        0o77</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    二元        0b1111_0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    字节（u8仅） b&#x27;A&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>bool类型就只有真假 不会默认帮忙转换</p></li><li><p>元组</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let x: (i32, f64, u8) = (500, 6.4, 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let five_hundred = x.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let six_point_four = x.1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let one = x.2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>数组</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let c: [i32; 5] = [1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let b = [3; 5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let a = [1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let first = a[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let second = a[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="函数">函数<a class="hash-link" href="#函数" title="标题的直接链接">​</a></h4><ol><li><p>不带;表示返回值</p></li><li><p>指定返回值</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn plus_one(x: i32) -&gt; i32 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="注释">注释<a class="hash-link" href="#注释" title="标题的直接链接">​</a></h4><p>讲解Crates.io的时候才说</p><h4 class="anchor anchorWithStickyNavbar_loeA" id="控制流">控制流<a class="hash-link" href="#控制流" title="标题的直接链接">​</a></h4><ol><li><p>使用<code>if</code>的<code>let</code>语句</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain"> fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let condition = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let number = if condition {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     println!(&quot;The value of number is: {}&quot;, number);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>从循环里面返回值出来</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut counter = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let result = loop {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter += 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if counter == 10 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            break counter * 2;// 我在想 这里没有; 为什么也能有值返回出去呢?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;The result is {}&quot;, result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>遍历</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let a = [10, 20, 30, 40, 50];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 方法1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for element in a.iter() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println!(&quot;the value is: {}&quot;, element);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 方法2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for number in (1..4).rev() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println!(&quot;{}!&quot;, number);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 方法3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while index &lt; 5 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println!(&quot;the value is: {}&quot;, a[index]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        index += 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="所有权">所有权<a class="hash-link" href="#所有权" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="什么是所有权">什么是所有权<a class="hash-link" href="#什么是所有权" title="标题的直接链接">​</a></h4><ol><li><p>每个内存只能被所有一次, 一旦被接管了就没了.</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 下述代码就会报错</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s1 = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s2 = s1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{}, world!&quot;, s1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error[E0382]: use of moved value: `s1`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --&gt; src/main.rs:5:28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    3 |     let s2 = s1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |         -- value moved here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    4 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5 |     println!(&quot;{}, world!&quot;, s1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |                            ^^ value used here after move</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    = note: move occurs because `s1` has type `std::string::String`, which does</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    not implement the `Copy` trait</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>如果想要拿到一样的内容的话 使用 <code>clone</code></p></li><li><p>对基础数据类型操作的是 会自动调用 <code>copy</code>, 由于都是在栈区, 不会产生新的内存空间</p></li><li><p>如果直接把某个变量交付给某个函数, 而该函数没有移交所有权出来的话, 他将不能再被使用了</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="引用和借阅">引用和借阅<a class="hash-link" href="#引用和借阅" title="标题的直接链接">​</a></h3><ol><li><p><code>&amp;</code> 表示引用该参数, 但不能进行变更, 如果要变更的话 需要 <code>&amp;mut</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut s = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    change(&amp;mut s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn change(some_string: &amp;mut String) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    some_string.push_str(&quot;, world&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>不能有两次可变引用, 因为不知道依据谁的改变</p></li><li><p>同上, 如果还存在多个后续依旧会使用的不可变引用时候, 不能创建可变引用, 因为不可变的引用是不知道可变引用的存在的, 但如果在使用后并且后续不再使用了之后, 就允许创建可变引用了</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let mut s = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let r1 = &amp;s; // no problem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let r2 = &amp;s; // no problem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{} and {}&quot;, r1, r2);  // 这里使用之后 后续就不再使用了 说明是可以的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// r1 and r2 are no longer used after this point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let r3 = &amp;mut s; // no problem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{}&quot;, r3);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>悬空, 什么意思呢, 可以理解为僵尸指针</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain"> fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let reference_to_nothing = dangle();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn dangle() -&gt; &amp;String {    // 这里将返回一个带有引用的数据类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = String::from(&quot;hello&quot;);  // 生成一个新的数据类型, 开辟可以一个新的内存空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;s  // 移交引用出去 代表是 我只是借你拿去用的意思</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}   // 但这里就已经被释放了 产生 僵尸指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn no_dangle() -&gt; String {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s   // 这里是把所有权给出去了 代表是 我开辟的空间 我不要了 你拿去用吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}   // 这样给出去的内存就不会被释放了</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="切片类型">切片类型<a class="hash-link" href="#切片类型" title="标题的直接链接">​</a></h4><ol><li><p>先看一个获取第一个单词的函数</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 借阅一个字符串   返回单词的下标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn first_word(s: &amp;String) -&gt; usize {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 转换为数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let bytes = s.as_bytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 遍历 bytes.iter() 并且创建迭代器 enumerate() 可以理解为 enumerate() 会产生出一个元组来</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (i, &amp;item) in bytes.iter().enumerate() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //  借阅到了 item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if item == b&#x27; &#x27; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return i;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s.len() // 乍一看没有问题 但, 其实这里涉及到了很多问题, 比方单词长度未知和 s 被销毁了 这组数据就失效了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>引入切片</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let s = String::from(&quot;hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let len = s.len();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[0..2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[..2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[3..len];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[3..];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[0..len];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;s[..];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p><code>&amp;str</code> 表示的是切片类型 <code>&amp;String</code> 表示的字符串类型</p></li><li><p>有了切片这个概念之后就可以改写取第一个单词的函数了</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn first_word(s: &amp;String) -&gt; &amp;str {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let bytes = s.as_bytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (i, &amp;item) in bytes.iter().enumerate() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if item == b&#x27; &#x27; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return &amp;s[0..i];    // 直接返回切片</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 刚好这里的 s 是借来的 所以直接拿着这玩意 转借给别人就行了 没我啥事了的意思</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;s[..]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>使用上述代码</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut s = String::from(&quot;hello world&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let word = first_word(&amp;s); // 这个切片还是用的 s 的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s.clear(); // 这里就会直接报错了 因为会获取s的可变引用并且把它清空, 而 world是 first_word 借了s又转手给了word的一个不可变引用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;the first word is: {}&quot;, word);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>把传入的 <code>&amp;String</code> 类型变成 <code>&amp;str</code> 类型 就可以接受 切片和字符串了 因为字符串就是全切片</p></li><li><p>其他的切片</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">    let a = [1, 2, 3, 4, 5];    // 他的类型是   [i32; 5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let slice = &amp;a[1..3];       // 切片的类型是 &amp;[i32]</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="使用结构体来构造相关数据">使用结构体来构造相关数据<a class="hash-link" href="#使用结构体来构造相关数据" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="定义和实例化结构">定义和实例化结构<a class="hash-link" href="#定义和实例化结构" title="标题的直接链接">​</a></h4><ol><li><p>定义一个结构体</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">struct User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    username: String,   // 现在先不声明为 &amp;str 切片类型 会涉及到生命周期</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sign_in_count: u64,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    active: bool,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn build_user(email: String, username: String) -&gt; User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        email: email,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: username,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        active: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sign_in_count: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 简化写法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn build_user(email: String, username: String) -&gt; User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        email,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        active: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sign_in_count: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut user1 = User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        email: String::from(&quot;someone@example.com&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: String::from(&quot;someusername123&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        active: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sign_in_count: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 点语法直接更改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user1.email = String::from(&quot;anotheremail@example.com&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 新建user2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let user2 = User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        email: String::from(&quot;another@example.com&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: String::from(&quot;anotherusername567&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        active: user1.active,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sign_in_count: user1.sign_in_count,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 但可以写成这样</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let user2 = User {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        email: String::from(&quot;another@example.com&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: String::from(&quot;anotherusername567&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ..user1 // 其他字段沿用该实例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>元组结构</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">struct Color(i32, i32, i32);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Point(i32, i32, i32);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let black = Color(0, 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let origin = Point(0, 0, 0);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>打印结构 首先添加 <code>#[derive(Debug)]</code> 和 然后改 <code>{}</code> 为 <code>{:?}</code> 或 <code>{:#?}</code> 多行打印
单行打印 : 表示打印出来的键值中间的 : ? 表示的是 值 # 表示立起来 变成多行 形式主义.. 个人理解</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(Debug)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Rectangle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    width: u32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: u32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn test_rect() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let rect1 = Rectangle { width: 30, height: 50 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;rect1 is {:?}&quot;, rect1);   // 表示的意思是</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;rect1 is {:#?}&quot;, rect1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="方块语法">方块语法<a class="hash-link" href="#方块语法" title="标题的直接链接">​</a></h4><ol><li><p>实现一个方法</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(Debug)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Rectangle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    width: u32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    height: u32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 实现 可以有多个实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl Rectangle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 这里的self都只是借来的 只做访问变量使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 但如果要用来修改其内容的话 也是需要加上mut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn area(&amp;self) -&gt; u32 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self.width * self.height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl Rectangle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 可以理解为定义了一个 类函数 只能通过类来调用 调用方式 采用 :: 双冒号形式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn square(size: u32) -&gt; Rectangle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Rectangle { width: size, height: size }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let rect1 = Rectangle { width: 30, height: 50 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;The area of the rectangle is {} square pixels.&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rect1.area()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let sq = Rectangle::square(3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>自动修改调用的第一个参数类型, 仅仅针对 <code>self</code> 参数   会自动添加他的变体 <code>&amp;</code>，<code>&amp;mut</code> 或 <code>*</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">#![allow(unused_variables)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[derive(Debug,Copy,Clone)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct Point {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x: f64,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        y: f64,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    impl Point {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn distance(&amp;self, other: &amp;Point) -&gt; f64 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let x_squared = f64::powi(other.x - self.x, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let y_squared = f64::powi(other.y - self.y, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            f64::sqrt(x_squared + y_squared)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let p1 = Point { x: 0.0, y: 0.0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let p2 = Point { x: 5.0, y: 6.5 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 这两个方法的调用时一无所谓的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p1.distance(&amp;p2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (&amp;p1).distance(&amp;p2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="枚举">枚举<a class="hash-link" href="#枚举" title="标题的直接链接">​</a></h4><ol><li><p>不得不承认 这么没有很吸引我</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 正常使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum IpAddrKind {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V6,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 混用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum IpAddr {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V4(u8, u8, u8, u8),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V6(String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Ipv4Addr {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Ipv6Addr {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结构体使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum IpAddr {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V4(Ipv4Addr),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    V6(Ipv6Addr),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 强大所在</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum Message {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Quit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Move { x: i32, y: i32 },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Write(String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ChangeColor(i32, i32, i32),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl Message {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 还能...实现 函数!!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn call(&amp;self) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // method body would be defined here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>Option
null的发明者Tony Hoare在2009年的演讲“ Null References：十亿美元的错误”中说：</p><div class="codeBlockContainer_X7hc language-text theme-code-block"><div class="codeBlockContent_vqWU text"><pre tabindex="0" class="prism-code language-text codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">    我称之为我的十亿美元错误。当时，我正在设计第一个全面的类型系统，以使用面向对象的语言进行引用。我的目标是确保所有引用的使用都绝对安全，并由编译器自动执行检查。但是我忍不住要插入一个空引用的诱惑，仅仅是因为它是如此容易实现。这导致了无数错误，漏洞和系统崩溃，在最近四十年中可能造成十亿美元的痛苦和破坏。</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">enum Option&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Some(T),    // 泛型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let some_number = Some(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let some_string = Some(&quot;a string&quot;);     // Some 直接赋值即可推测类型了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let absent_number: Option&lt;i32&gt; = None;  // None 没有类型 那么就需要指代类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>加入Option 旨在限制null的普遍性并提高Rust代码的安全性。</p></li><li><p>匹配控制流 <code>match</code></p><p>一个强大的武器</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">enum UsState {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Alabama,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Alaska,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum Coin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Penny,      // 1 美分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nickel,     // 5 美分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dime,       // 10 美分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Quarter(UsState),    // 25 美分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn value_in_cents(coin: Coin) -&gt; u8 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    match coin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 类函数的调用方式 指定 枚举的每个值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Coin::Penny =&gt; {    // =&gt; 匹配后直接赋值的意思</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            println!(&quot;Lucky penny!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1   // 返回值为1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Coin::Nickel =&gt; 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Coin::Dime =&gt; 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Coin::Quarter(state) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            println!(&quot;State quarter from {:?}!&quot;, state);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p><code>match</code> 搭配 <code>Option&lt;T&gt;</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn plus_one(x: Option&lt;i32&gt;) -&gt; Option&lt;i32&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    match x {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        None =&gt; None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Some(i) =&gt; Some(i + 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let five = Some(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let six = plus_one(five);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let none = plus_one(None);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p><code>_</code> 占位符 类似于 <code>default</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let some_u8_value = 0u8; // 等价于  let some_u8_value : u8 = 1; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">match some_u8_value {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1 =&gt; println!(&quot;one&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    3 =&gt; println!(&quot;three&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5 =&gt; println!(&quot;five&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    7 =&gt; println!(&quot;seven&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ =&gt; (),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>就算使用了占位符 但如果我们只要匹配一种模式的话 用<code>match</code>有点焉用牛刀的感觉了 所以引入了 <code>if let</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 牛刀模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let some_u8_value = Some(0u8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">match some_u8_value {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Some(3) =&gt; println!(&quot;three&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ =&gt; (),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 简约模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if let Some(3) = some_u8_value {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;three&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>换句话说，您可以将其<code>if let</code>视为<code>match</code>当值匹配一个模式然后忽略所有其他值时运行代码的语法语法。</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="使用包头文件">使用包(头文件)<a class="hash-link" href="#使用包头文件" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="包">包<a class="hash-link" href="#包" title="标题的直接链接">​</a></h4><ol><li>在使用<code>cargo</code>的时候, 生成出来的 <code>src</code> 其实就是一个包</li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="模块-mod">模块 <code>mod</code><a class="hash-link" href="#模块-mod" title="标题的直接链接">​</a></h4><ol><li><p>样板</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">mod front_of_house {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 如果这里不添加 pub 的话 是没有办法在外部使用的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub mod hosting {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pub fn add_to_waitlist() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn seat_at_table() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mod serving {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn take_order() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn serve_order() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn take_payment() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><div class="codeBlockContainer_X7hc language-javascript theme-code-block"><div class="codeBlockContent_vqWU javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">pub fn </span><span class="token function" style="color:#d73a49">eat_at_restaurant</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 绝对路径调用的时候 采用的关键字是 crate 箱子 其实可以理解为当前目录 root</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">crate</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">front_of_house</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">hosting</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token function" style="color:#d73a49">add_to_waitlist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 相对路径调用的时候可以省略</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">front_of_house</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">hosting</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token function" style="color:#d73a49">add_to_waitlist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain">`</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><ol start="2"><li><p>模块树</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">crate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── front_of_house</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── hosting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── add_to_waitlist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── seat_at_table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── serving</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── take_order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── serve_order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── take_payment</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>起始相对路径 <code>super</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn serve_order() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mod back_of_house {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn fix_incorrect_order() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cook_order();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 这里的super意思就是 back_of_house 而且 serve_order 和 super 同级</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super::serve_order();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn cook_order() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="使用-use-来引入路径-缩短路径">使用 <code>use</code> 来引入路径 缩短路径<a class="hash-link" href="#使用-use-来引入路径-缩短路径" title="标题的直接链接">​</a></h4><ol><li><p>正常使用</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">mod front_of_house {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub mod hosting {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pub fn add_to_waitlist() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use crate::front_of_house::hosting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn eat_at_restaurant() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 绝对路径下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    crate::front_of_house::hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 相对路径下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    front_of_house::hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 被缩短的使用方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p><code>as</code> 来重写命名</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use std::fmt::Result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use std::io::Result as IoResult;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn function1() -&gt; Result {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ok(())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn function2() -&gt; IoResult&lt;()&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // --snip--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ok(())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>导出 <code>pub use</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">mod front_of_house {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub mod hosting {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pub fn add_to_waitlist() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 外部访问可以直接访问 hosting::add_to_waitlist()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub use crate::front_of_house::hosting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn eat_at_restaurant() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hosting::add_to_waitlist();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>对于同一包下的多个路径使用嵌套处理 <code>{ , }</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::Write;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::cmp::Ordering;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::{cmp::Ordering, io};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 对于路径本身 使用 self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::{self, Write};</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>导入所有的公共项目</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::collections::*;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>模块 <code>mod</code> 分文件存放</p><p>这个不需要太多的内容去写 大概就是和安卓的机制类似 文件夹存放即可</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="常用的一些键值保存的东西">常用的一些键值保存的东西<a class="hash-link" href="#常用的一些键值保存的东西" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="矢量">矢量<a class="hash-link" href="#矢量" title="标题的直接链接">​</a></h4><ol><li><p>矢量 <code>Vec</code> 可以存放任何类型, 但仅限于同一类型的, 所以可以借助 <code>enum</code> 来达到混存的功能</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let v: Vec&lt;i32&gt; = Vec::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v.push(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v.push(6);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let v = vec![1, 2, 3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum SpreadsheetCell {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Int(i32),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Float(f64),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Text(String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let row = vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SpreadsheetCell::Int(3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SpreadsheetCell::Text(String::from(&quot;blue&quot;)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SpreadsheetCell::Float(10.12),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">];</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>如果已经生成过了个 不可变 的引用之后, 再继续对其push</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let mut v = vec![1, 2, 3, 4, 5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let first = &amp;v[0];  // 产生不可变的引用之后</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v.push(6);          // 这里会生成 可变</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;The first element is: {}&quot;, first);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>可以直接对其遍历</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let v = vec![100, 32, 57];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in &amp;v {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;{}&quot;, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 如果要改值得话 需要加 mut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in &amp;mut v {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 甚至是直接遍历的时候更改他的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *i += 50; // * 有点强买强卖的问道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="string">String<a class="hash-link" href="#string" title="标题的直接链接">​</a></h4><ol><li><p>不能对 <code>String</code> 索引</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let hello = &quot;Здравствуйте&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let answer = &amp;hello[0]; // 因为Unicode吗的字节长度是不定的</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>字符串的一些相关操作</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 追加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let mut s1 = String::from(&quot;foo&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s2 = &quot;bar&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s1.push_str(s2); // 这里并不会转让所有权</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;s2 is {}&quot;, s2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let mut s = String::from(&quot;lo&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s.push(&#x27;l&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 合并</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 加号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s1 = String::from(&quot;Hello, &quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s2 = String::from(&quot;world!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s3 = s1 + &amp;s2; // s1 的所有权被移交出去了 + 号其实调用的是 add 方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 格式化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s1 = String::from(&quot;tic&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s2 = String::from(&quot;tac&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s3 = String::from(&quot;toe&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s = format!(&quot;{}-{}-{}&quot;, s1, s2, s3);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>但可以对字符串做范围切片 但是会可能报错</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let hello = &quot;Здравствуйте&quot;; // 这里的一个字符占两个字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let s = &amp;hello[0..4];       // 所以 0到4 取出来的是 &#x27;Зд&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 一旦取了 [0..1] 或者是 [0..3] 就会导致字符无法被正常切出来 会报错</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>遍历字符串的真正字符 使用 <code>chars</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">for c in &quot;नमस्ते&quot;.chars() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;{}&quot;, c);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>或者遍历字符串的字节码 使用 <code>bytes</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">for b in &quot;नमस्ते&quot;.bytes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;{}&quot;, b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="hashmap">HashMap<a class="hash-link" href="#hashmap" title="标题的直接链接">​</a></h4><ol><li><p>所有的键值必须一致, 也就是键的类型要一致, 值的类型也要一致</p></li><li><p>使用</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::collections::HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let mut scores = HashMap::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 一个一个插入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.insert(String::from(&quot;Blue&quot;), 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.insert(String::from(&quot;Yellow&quot;), 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 先创建所有的键 和 值 存放到 vec当中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let teams  = vec![String::from(&quot;Blue&quot;), String::from(&quot;Yellow&quot;)];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let initial_scores = vec![10, 50];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 这里的 下划线是可以编译器 自己去猜测的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let scores: HashMap&lt;_, _&gt; = teams.iter().zip(initial_scores.iter()).collect();</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>会接收所有权</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let field_name = String::from(&quot;Favorite color&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let field_value = String::from(&quot;Blue&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let mut map = HashMap::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.insert(field_name, field_value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 下面这行代码会报错的 所有权失效了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{}, {}&quot;, field_name, field_value);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>获取值 <code>get</code> 返回的是个 <code>Option</code> 值 因为是有可能为 <code>None</code>的</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">scores.insert(String::from(&quot;Blue&quot;), 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.insert(String::from(&quot;Yellow&quot;), 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let team_name = String::from(&quot;Blue&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let score = scores.get(&amp;team_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// score =&gt; Some(10)</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>仅当键没有值时才插入值 <code>entry</code> <code>or_insert</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let mut scores = HashMap::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.insert(String::from(&quot;Blue&quot;), 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.entry(String::from(&quot;Yellow&quot;)).or_insert(50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scores.entry(String::from(&quot;Blue&quot;)).or_insert(50);   // 这里不会生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{:?}&quot;, scores);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>更新值 但这里感觉有点问题</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let text = &quot;hello world wonderful world&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let mut map = HashMap::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for word in text.split_whitespace() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let count = map.entry(word).or_insert(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *count += 1; // 在这里更新了 但是就怎么那么怪呢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println!(&quot;{:?}&quot;, map);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><div class="codeBlockContainer_X7hc language-javascript theme-code-block"><div class="codeBlockContent_vqWU javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 如果按照上述这个思路的话</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scores</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">String</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword module" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Blue&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">or_insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token plain">score </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain">`</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><h3 class="anchor anchorWithStickyNavbar_loeA" id="报错-panic">报错 <code>panic!</code><a class="hash-link" href="#报错-panic" title="标题的直接链接">​</a></h3><ol><li><p>关于 <code>panic!</code></p></li><li><p><code>Result</code></p><p>这是一个枚举, 表示这个值可以是有两种结果, 如果是<code>OK</code>会附带对应的<code>&lt;T&gt;</code>类型, 如果是<code>Err</code>的话, 将会是报错</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">enum Result&lt;T, E&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ok(T),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Err(E),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = match f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ok(file) =&gt; file,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err(error) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 这里的 panic! 表示会直接停止在这里</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            panic!(&quot;Problem opening the file: {:?}&quot;, error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 甚至可以匹配不同的错误 也就是针对 err 的错误类型做文章</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::ErrorKind;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = match f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Ok(file) =&gt; file,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err(error) =&gt; match error.kind() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ErrorKind::NotFound =&gt; match File::create(&quot;hello.txt&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok(fc) =&gt; fc,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Err(e) =&gt; panic!(&quot;Problem creating the file: {:?}&quot;, e),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            other_error =&gt; panic!(&quot;Problem opening the file: {:?}&quot;, other_error),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>闭包</p><p>如果在使用多个<code>match</code>会使得代码看起来很原始</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::ErrorKind;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;).unwrap_or_else(|error| {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if error.kind() == ErrorKind::NotFound {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            File::create(&quot;hello.txt&quot;).unwrap_or_else(|error| {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                panic!(&quot;Problem creating the file: {:?}&quot;, error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            panic!(&quot;Problem opening the file: {:?}&quot;, error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>新的关键字用来单独解决报错 <code>unwrap</code> 和 <code>expect</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;).unwrap();   // 如果报错 会直接中断在这里</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;).expect(&quot;Failed to open hello.txt&quot;); // 如果报错 会直接显示错误信息 并且中断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>传递报错</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use std::io::Read;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 首先看返回值 是个 Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let f = File::open(&quot;hello.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 判断 f 是否是错误 如果是的话直接返回报错 否则直接赋值为文件的 句柄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut f = match f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Ok(file) =&gt; file,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Err(e) =&gt; return Err(e),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut s = String::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 匹配文件读出来的内容给到 新建的 s 当中去</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match f.read_to_string(&amp;mut s) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Ok(_) =&gt; Ok(s),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Err(e) =&gt; Err(e),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }   // 这里没有 ; 表示这里就是返回值了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>由于以上传递 非常常见 导致可以 用 <code>?</code> 使其精简 </p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::Read;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut f = File::open(&quot;hello.txt&quot;)?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut s = String::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f.read_to_string(&amp;mut s)?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ok(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>该<code>?</code>放在后<code>Result</code>值定义为工作在几乎相同的方式<code>match</code>表达我们定义来处理<code>Result</code>
也就是可以直接做到简化返回操作的能力
甚至更加的精简</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::Read;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut s = String::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File::open(&quot;hello.txt&quot;)?.read_to_string(&amp;mut s)?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ok(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>好吧 其实还可以超级精简</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::io;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 我觉得这里已经癫了 直接帮你写好了 打开文件夹并且获取内容 并且返回出去...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fs::read_to_string(&quot;hello.txt&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>那么这个<code>?</code>能用在别的地方吗? 不能的 只能用在返回值为 <code>Result</code> 的函数上</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 错误代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;)?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>这里说一嘴 <code>main</code> 函数的返回值是 <code>()</code> 我完全不知道这是个什么类型...</p><p>但你可以这么写</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::error::Error;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::fs::File;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let f = File::open(&quot;hello.txt&quot;)?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 返回了 () 的同时 耶 完成了 ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ok(())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>但这里出现了个新的玩意 <code>Box&lt;dyn Error&gt;</code> <code>Box</code> 看了文档不是很懂 <code>pub struct Box&lt;T: ?Sized&gt;(Unique&lt;T&gt;);</code>
但 <code>dyn</code> 表示可以是任何类型
所以 <code>Box&lt;dyn Error&gt;</code> 可以理解为 任何类型的错误</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="泛型-特征-和-生命周期">泛型 特征 和 生命周期<a class="hash-link" href="#泛型-特征-和-生命周期" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="特征">特征<a class="hash-link" href="#特征" title="标题的直接链接">​</a></h4><ol><li><p>定义共同接口</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">pub trait Summary {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn summarize(&amp;self) -&gt; String;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub struct NewsArticle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub headline: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub location: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub author: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub content: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 实现接口 对于 NewsArticle 这个结构体来说</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl Summary for NewsArticle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn summarize(&amp;self) -&gt; String {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        format!(&quot;{}, by {} ({})&quot;, self.headline, self.author, self.location)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub struct Tweet {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub username: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub content: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub reply: bool,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub retweet: bool,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 实现接口 对于 Tweet 这个结构体来说</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">impl Summary for Tweet {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn summarize(&amp;self) -&gt; String {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        format!(&quot;{}: {}&quot;, self.username, self.content)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>不能实现外部特征, 只能本地使用</p></li><li><p>可以默认实现特征, 这样本地就都可以使用了</p></li><li><p>特征可以作为参数, 也就是必须实现这个特征的任意类型</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 单独使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify(item: impl Summary) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Breaking news! {}&quot;, item.summarize());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 提取出来使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify&lt;T: Summary&gt;(item: T) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Breaking news! {}&quot;, item.summarize());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 正常单独使用多个</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify(item1: impl Summary, item2: impl Summary) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 但可以写成这样</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify&lt;T: Summary&gt;(item1: T, item2: T) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 可以相加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify(item: impl Summary + Display) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 当然也可以提取出来</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pub fn notify&lt;T: Summary + Display&gt;(item: T) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 但如果有多个的时候 就会很乱</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn some_function&lt;T: Display + Clone, U: Clone + Debug&gt;(t: T, u: U) -&gt; i32 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 可以使用 where 来后续补充说明</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn some_function&lt;T, U&gt;(t: T, u: U) -&gt; i32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where T: Display + Clone,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        U: Clone + Debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>既然能做参数, 那么也能做返回值</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn returns_summarizable() -&gt; impl Summary {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tweet {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: String::from(&quot;horse_ebooks&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        content: String::from(&quot;of course, as you probably already know, people&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reply: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retweet: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 但有局限性 也就是说 这样是不允许的 只允许返回一个类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn returns_summarizable(switch: bool) -&gt; impl Summary {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if switch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NewsArticle {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tweet {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>完成之前的比大小</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// PartialOrd 可以比较 Copy 可以进行拷贝 代表就是在堆上的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn largest&lt;T: PartialOrd + Copy&gt;(list: &amp;[T]) -&gt; T {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut largest = list[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for &amp;item in list.iter() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if item &gt; largest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            largest = item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    largest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="lifetime-寿命"><code>lifetime</code> 寿命<a class="hash-link" href="#lifetime-寿命" title="标题的直接链接">​</a></h4><ol><li><p>三条规则</p><ol><li><p>作为引用的参数都有其自己的寿命 <code>fn foo&lt;&#x27;a, &#x27;b&gt;(x: &amp;&#x27;a i32, y: &amp;&#x27;b i32);</code></p></li><li><p>如果存在一个有输入寿命的参数的时候, 那么返回的也得是这个带有寿命的参数</p></li><li><p>如果有多个不同寿命参数, 但其中有的是 <code>&amp;self</code> 或者是 <code>&amp;mut self</code>, 那么就把 <code>self</code> 分配给所有输出寿命参数???</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">// 分析 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn first_word(s: &amp;str) -&gt; &amp;str {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 由于没有指定 那么就算是 先执行第一条规则 给所有的引用参数指定寿命</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn first_word(s: &amp;&#x27;a str) -&gt; &amp;str {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 又只有一个寿命类型, 那么把输入的寿命给到输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn first_word(s: &amp;&#x27;a str) -&gt; &amp;&#x27;a str {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 那么现在，此函数所有引用都具有寿命，并且编译器可以继续进行分析，所以我们就不用编写这个寿命了</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol></li></ol><div class="codeBlockContainer_X7hc language-javascript theme-code-block"><div class="codeBlockContent_vqWU javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 分析 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn </span><span class="token function" style="color:#d73a49">longest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">y</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">str </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 由于没有指定 入参的寿命 所以先执行第一条规则</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn </span><span class="token function" style="color:#d73a49">longest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token string" style="color:#e3116c">&#x27;a str, y: &amp;&#x27;</span><span class="token plain">b str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">str </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 第二条规则适用? 由于有多个不适用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 第三条规则呢? 没有 self 也不适用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 所以这个编译的时候 就会报错</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain">`</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><h3 class="anchor anchorWithStickyNavbar_loeA" id="自动化测试">自动化测试<a class="hash-link" href="#自动化测试" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_loeA" id="构建命令行程序">构建命令行程序<a class="hash-link" href="#构建命令行程序" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_loeA" id="闭包和迭代器">闭包和迭代器<a class="hash-link" href="#闭包和迭代器" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="闭包">闭包<a class="hash-link" href="#闭包" title="标题的直接链接">​</a></h4><ol><li><p>可以不指定数据类型, 但使用的时候 不能乱用, 他不是泛型</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn  add_one_v1   (x: u32) -&gt; u32 { x + 1 }  // 函数 完整版</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let add_one_v2 = |x: u32| -&gt; u32 { x + 1 }; // 闭包 完整版</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let add_one_v3 = |x|             { x + 1 }; // 闭包 删除指定数据类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let add_one_v4 = |x|               x + 1  ; // 闭包 删除花括号</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><div class="codeBlockContainer_X7hc language-javascript theme-code-block"><div class="codeBlockContent_vqWU javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 但在使用后上</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> example_closure </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">example_closure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">String</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword module" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;hello&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 使用了字符串作为参数传入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">example_closure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic">// 又使用了 数字  这里会崩</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain">`</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><ol start="2"><li><p>闭包也是有特征的, 这样的话就可以作为泛型的参数传入了 <code>Fn</code> <code>FnMut</code> <code>FnOnce</code></p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">struct Cacher&lt;T&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where T: Fn(u32) -&gt; u32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    calculation: T,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value: Option&lt;u32&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>闭包可以使用外部的变量</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let x = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let equal_to_x = |z| z == x;    // 使用了 x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // fn equal_to_x(z: i32) -&gt; bool { z == x } //这个就会崩</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let y = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert!(equal_to_x(y));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div><p>所以说闭包是会强制获取所有权的
<code>FnOnce</code>    获取完后 但只能调用一次
<code>FnMut</code>     可变的形式获取了值
<code>Fn</code>        不可变的形式获取了值</p></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="迭代器">迭代器<a class="hash-link" href="#迭代器" title="标题的直接链接">​</a></h4><ol><li><p>特征为 <code>Iterator</code> 和 具有 <code>next</code> 方法</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">pub trait Iterator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type Item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p><code>next</code> 是会消耗掉的</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn iterator_demonstration() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let v1 = vec![1, 2, 3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut v1_iter = v1.iter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(v1_iter.next(), Some(&amp;1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(v1_iter.next(), Some(&amp;2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(v1_iter.next(), Some(&amp;3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(v1_iter.next(), None);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn iterator_sum() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let v1 = vec![1, 2, 3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let v1_iter = v1.iter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let total: i32 = v1_iter.sum();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(total, 6);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>迭代器是不会自己调用的</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">let v1: Vec&lt;i32&gt; = vec![1, 2, 3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v1.iter().map(|x| x + 1);   // 这么使用时会收到警告 说明这行代码没有起到任何作用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let v2: Vec&lt;_&gt; = v1.iter().map(|x| x + 1).collect();    // 直接进行迭代</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert_eq!(v2, vec![2, 3, 4]);</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li><li><p>使用场景</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">#![allow(unused_variables)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[derive(PartialEq, Debug)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct Shoe {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    size: u32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    style: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn shoes_in_my_size(shoes: Vec&lt;Shoe&gt;, shoe_size: u32) -&gt; Vec&lt;Shoe&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shoes.into_iter()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .filter(|s| s.size == shoe_size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .collect()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn filters_by_size() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let shoes = vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Shoe { size: 10, style: String::from(&quot;sneaker&quot;) },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Shoe { size: 13, style: String::from(&quot;sandal&quot;) },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Shoe { size: 10, style: String::from(&quot;boot&quot;) },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let in_my_size = shoes_in_my_size(shoes, 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert_eq!(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        in_my_size,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Shoe { size: 10, style: String::from(&quot;sneaker&quot;) },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Shoe { size: 10, style: String::from(&quot;boot&quot;) },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="cratesio">Crates.io<a class="hash-link" href="#cratesio" title="标题的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_loeA" id="智能指针">智能指针<a class="hash-link" href="#智能指针" title="标题的直接链接">​</a></h3><ol><li><code>Rc&lt;T&gt;</code> 允许对一个变量有多个所有者；<code>Box&lt;T&gt;</code> 和 <code>RefCell&lt;T&gt;</code> 只能有一个所有者。</li><li><code>Box&lt;T&gt;</code> 允许在编译时检查是不可变还是可变的；<code>Rc&lt;T&gt;</code> 只允许在编译时检查不可变的引用；<code>RefCell&lt;T&gt;</code> 允许在运行时检查不可变或可变的引用。</li><li>由于<code>RefCell&lt;T&gt;</code>允许在运行时检查可变引用，因此 <code>RefCell&lt;T&gt;</code> 即使<code>RefCell&lt;T&gt;</code> 是不可变的，也可以在内部改变值。</li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="并发">并发<a class="hash-link" href="#并发" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_loeA" id="线程">线程<a class="hash-link" href="#线程" title="标题的直接链接">​</a></h4><ol><li><p>创建线程 <code>thread::spawn</code></p></li><li><p>等待该线程跑完 <code>join</code> 阻塞的</p></li><li><p>线程内使用外部的值 其实也可以看做是 闭包内使用外部变量 但闭包是在单一线程下使用的 <code>move</code> 是针对线程闭包的 所以 会强制获取所有权</p></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="通道">通道<a class="hash-link" href="#通道" title="标题的直接链接">​</a></h4><ol><li><p>例子</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::sync::mpsc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let (tx, rx) = mpsc::channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    thread::spawn(move || {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let val = String::from(&quot;hi&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tx.send(val).unwrap();  // 移交所有权</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let received = rx.recv().unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Got: {}&quot;, received);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol><h4 class="anchor anchorWithStickyNavbar_loeA" id="上锁">上锁<a class="hash-link" href="#上锁" title="标题的直接链接">​</a></h4><ol><li><p>互斥 和 原子引用计数</p><div class="codeBlockContainer_X7hc language-rust theme-code-block"><div class="codeBlockContent_vqWU rust"><pre tabindex="0" class="prism-code language-rust codeBlock_wPnj thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_fQUY"><span class="token-line" style="color:#393A34"><span class="token plain">use std::sync::{Mutex, Arc};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::thread;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let counter = Arc::new(Mutex::new(0));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut handles = vec![];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for _ in 0..10 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let counter = Arc::clone(&amp;counter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let handle = thread::spawn(move || {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let mut num = counter.lock().unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            *num += 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handles.push(handle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for handle in handles {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handle.join().unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println!(&quot;Result: {}&quot;, *counter.lock().unwrap());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_H_xL clean-btn">复制</button></div></div></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/server"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">部署新安装的centos服务器</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2019/mac"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">mac上启动文件服务器</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#安装" class="table-of-contents__link toc-highlight">安装</a><ul><li><a href="#brew-安装" class="table-of-contents__link toc-highlight">brew 安装</a></li><li><a href="#官网方法" class="table-of-contents__link toc-highlight">官网方法</a></li></ul></li><li><a href="#入门" class="table-of-contents__link toc-highlight">入门</a><ul><li><a href="#rustc-编译" class="table-of-contents__link toc-highlight">rustc 编译</a></li><li><a href="#cargo" class="table-of-contents__link toc-highlight">Cargo</a></li><li><a href="#编写猜谜游戏" class="table-of-contents__link toc-highlight">编写猜谜游戏</a></li><li><a href="#通用编程概念" class="table-of-contents__link toc-highlight">通用编程概念</a></li><li><a href="#所有权" class="table-of-contents__link toc-highlight">所有权</a></li><li><a href="#引用和借阅" class="table-of-contents__link toc-highlight">引用和借阅</a></li><li><a href="#使用结构体来构造相关数据" class="table-of-contents__link toc-highlight">使用结构体来构造相关数据</a></li><li><a href="#使用包头文件" class="table-of-contents__link toc-highlight">使用包(头文件)</a></li><li><a href="#常用的一些键值保存的东西" class="table-of-contents__link toc-highlight">常用的一些键值保存的东西</a></li><li><a href="#报错-panic" class="table-of-contents__link toc-highlight">报错 <code>panic!</code></a></li><li><a href="#泛型-特征-和-生命周期" class="table-of-contents__link toc-highlight">泛型 特征 和 生命周期</a></li><li><a href="#自动化测试" class="table-of-contents__link toc-highlight">自动化测试</a></li><li><a href="#构建命令行程序" class="table-of-contents__link toc-highlight">构建命令行程序</a></li><li><a href="#闭包和迭代器" class="table-of-contents__link toc-highlight">闭包和迭代器</a></li><li><a href="#cratesio" class="table-of-contents__link toc-highlight">Crates.io</a></li><li><a href="#智能指针" class="table-of-contents__link toc-highlight">智能指针</a></li><li><a href="#并发" class="table-of-contents__link toc-highlight">并发</a></li></ul></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.svg" alt="" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/logo.svg" alt="" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">© 2022 danyow, Inc. 使用 Docusaurus 构建。</div></div></div></footer></div>
<script src="/assets/js/runtime~main.48a3e1d8.js"></script>
<script src="/assets/js/main.c1c30879.js"></script>
</body>
</html>